<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据管理 - 管理后台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="miniprogram-container">
        <!-- 导航栏 -->
        <div class="navbar" style="background: linear-gradient(135deg, #1e293b 0%, #334155 100%);">
            <div class="flex items-center justify-between w-full">
                <h1 class="text-lg font-bold">
                    <i class="fas fa-database mr-2"></i>
                    数据管理
                </h1>
            </div>
        </div>

        <!-- 时间筛选 -->
        <div class="bg-white mx-3 mt-3 rounded-xl shadow-sm p-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold text-gray-800 text-base">
                    <i class="fas fa-calendar-alt mr-2 text-blue-600"></i>
                    统计周期
                </h3>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <button class="px-4 py-3 bg-blue-600 text-white rounded-xl text-sm font-medium shadow-sm" onclick="setDateRange('today')">
                    <i class="fas fa-calendar-day mr-2"></i>今日
                </button>
                <button class="px-4 py-3 bg-gray-100 text-gray-600 rounded-xl text-sm font-medium" onclick="setDateRange('week')">
                    <i class="fas fa-calendar-week mr-2"></i>本周
                </button>
                <button class="px-4 py-3 bg-gray-100 text-gray-600 rounded-xl text-sm font-medium" onclick="setDateRange('month')">
                    <i class="fas fa-calendar mr-2"></i>本月
                </button>
                <button class="px-4 py-3 bg-gray-100 text-gray-600 rounded-xl text-sm font-medium" onclick="setDateRange('custom')">
                    <i class="fas fa-edit mr-2"></i>自定义
                </button>
            </div>
        </div>

        <!-- 总体统计 -->
        <div class="mx-3 mt-4">
            <h3 class="font-semibold text-gray-800 mb-4 text-base">
                <i class="fas fa-chart-line mr-2 text-blue-600"></i>
                数据概览
            </h3>
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-sm p-4 text-center border border-blue-200">
                    <div class="text-2xl font-bold text-blue-600 mb-1">18</div>
                    <div class="text-sm text-gray-700 font-medium">转发任务</div>
                    <div class="text-xs text-gray-500 mt-1">总任务数</div>
                </div>
                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-sm p-4 text-center border border-green-200">
                    <div class="text-2xl font-bold text-green-600 mb-1">15</div>
                    <div class="text-sm text-gray-700 font-medium">已完成</div>
                    <div class="text-xs text-gray-500 mt-1">完成数量</div>
                </div>
                <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl shadow-sm p-4 text-center border border-orange-200">
                    <div class="text-2xl font-bold text-orange-600 mb-1">83%</div>
                    <div class="text-sm text-gray-700 font-medium">完成率</div>
                    <div class="text-xs text-gray-500 mt-1">效率指标</div>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl shadow-sm p-4 text-center border border-purple-200">
                    <div class="text-2xl font-bold text-purple-600 mb-1">12</div>
                    <div class="text-sm text-gray-700 font-medium">参与员工</div>
                    <div class="text-xs text-gray-500 mt-1">活跃人数</div>
                </div>
            </div>
        </div>

        <!-- 每日每员转发统计 -->
        <div class="mx-3 mt-4">
            <h3 class="font-semibold text-gray-800 mb-4 text-base">
                <i class="fas fa-users mr-2 text-green-600"></i>
                员工转发统计
            </h3>
            
            <!-- 筛选和导出按钮 -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-4">
                <div class="flex flex-col space-y-3">
                    <!-- 门店筛选 -->
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-filter mr-1 text-gray-500"></i>
                            门店筛选
                        </label>
                        <button id="storeFilterBtn" class="w-full bg-gray-50 text-gray-700 px-4 py-3 rounded-xl text-sm border border-gray-200 flex items-center justify-between hover:bg-gray-100 transition-colors" onclick="toggleStoreFilter()">
                            <span id="storeFilterText">全部门店</span>
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </button>
                        <div id="storeFilterDropdown" class="absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-lg border z-20 hidden">
                            <div class="p-3 space-y-2">
                                <label class="flex items-center text-sm cursor-pointer hover:bg-gray-50 p-2 rounded-lg">
                                    <input type="checkbox" value="all" class="mr-3 w-4 h-4 text-blue-600" onchange="updateStoreFilter()" checked>
                                    全部门店
                                </label>
                                <label class="flex items-center text-sm cursor-pointer hover:bg-gray-50 p-2 rounded-lg">
                                    <input type="checkbox" value="万达广场店" class="mr-3 w-4 h-4 text-blue-600" onchange="updateStoreFilter()">
                                    万达广场店
                                </label>
                                <label class="flex items-center text-sm cursor-pointer hover:bg-gray-50 p-2 rounded-lg">
                                    <input type="checkbox" value="银泰城店" class="mr-3 w-4 h-4 text-blue-600" onchange="updateStoreFilter()">
                                    银泰城店
                                </label>
                                <label class="flex items-center text-sm cursor-pointer hover:bg-gray-50 p-2 rounded-lg">
                                    <input type="checkbox" value="万象城店" class="mr-3 w-4 h-4 text-blue-600" onchange="updateStoreFilter()">
                                    万象城店
                                </label>
                                <label class="flex items-center text-sm cursor-pointer hover:bg-gray-50 p-2 rounded-lg">
                                    <input type="checkbox" value="大悦城店" class="mr-3 w-4 h-4 text-blue-600" onchange="updateStoreFilter()">
                                    大悦城店
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 导出报告 -->
                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-xl text-sm font-medium transition-colors shadow-sm" onclick="showExportOptions()">
                        <i class="fas fa-download mr-2"></i>
                        导出报告
                    </button>
                </div>
            </div>
            
            <!-- 员工转发详情 -->
            <div class="space-y-4">
                <!-- 员工1 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">张三</h4>
                                <p class="text-sm text-gray-500">EMP001 | 万达广场店</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-green-600">3/3</div>
                            <div class="text-sm text-gray-500">100%</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">周末大促销活动</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">新品上市推广</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">节日促销活动</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 员工2 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-orange-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">李四</h4>
                                <p class="text-sm text-gray-500">EMP002 | 银泰城店</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-orange-600">2/3</div>
                            <div class="text-sm text-gray-500">67%</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">周末大促销活动</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">新品上市推广</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-red-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">节日促销活动</span>
                            <span class="text-red-500 font-medium">
                                <i class="fas fa-times-circle mr-1"></i>未完成
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 员工3 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-red-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">王五</h4>
                                <p class="text-sm text-gray-500">EMP003 | 万象城店</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-red-600">1/3</div>
                            <div class="text-sm text-gray-500">33%</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">周末大促销活动</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-red-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">新品上市推广</span>
                            <span class="text-red-500 font-medium">
                                <i class="fas fa-times-circle mr-1"></i>未完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-red-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">节日促销活动</span>
                            <span class="text-red-500 font-medium">
                                <i class="fas fa-times-circle mr-1"></i>未完成
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 员工4 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">赵六</h4>
                                <p class="text-sm text-gray-500">EMP004 | 大悦城店</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-green-600">3/3</div>
                            <div class="text-sm text-gray-500">100%</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">周末大促销活动</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">新品上市推广</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                        <div class="flex items-center justify-between text-sm bg-green-50 p-2 rounded-lg">
                            <span class="text-gray-700 font-medium">节日促销活动</span>
                            <span class="text-green-600 font-medium">
                                <i class="fas fa-check-circle mr-1"></i>已完成
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 门店统计 -->
        <div class="mx-3 mt-4">
            <h3 class="font-semibold text-gray-800 mb-4 text-base">
                <i class="fas fa-store mr-2 text-purple-600"></i>
                门店统计
            </h3>
            <div class="space-y-3">
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-6 h-6 bg-blue-500 rounded-full mr-3 flex items-center justify-center">
                                <i class="fas fa-store text-white text-xs"></i>
                            </div>
                            <span class="font-semibold text-gray-800 text-base">万达广场店</span>
                        </div>
                        <span class="text-sm text-gray-600 font-medium">4人 | 100%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div class="bg-blue-500 h-3 rounded-full" style="width: 100%"></div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-6 h-6 bg-green-500 rounded-full mr-3 flex items-center justify-center">
                                <i class="fas fa-store text-white text-xs"></i>
                            </div>
                            <span class="font-semibold text-gray-800 text-base">银泰城店</span>
                        </div>
                        <span class="text-sm text-gray-600 font-medium">3人 | 67%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div class="bg-green-500 h-3 rounded-full" style="width: 67%"></div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-6 h-6 bg-orange-500 rounded-full mr-3 flex items-center justify-center">
                                <i class="fas fa-store text-white text-xs"></i>
                            </div>
                            <span class="font-semibold text-gray-800 text-base">万象城店</span>
                        </div>
                        <span class="text-sm text-gray-600 font-medium">2人 | 33%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div class="bg-orange-500 h-3 rounded-full" style="width: 33%"></div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-6 h-6 bg-purple-500 rounded-full mr-3 flex items-center justify-center">
                                <i class="fas fa-store text-white text-xs"></i>
                            </div>
                            <span class="font-semibold text-gray-800 text-base">大悦城店</span>
                        </div>
                        <span class="text-sm text-gray-600 font-medium">3人 | 100%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div class="bg-purple-500 h-3 rounded-full" style="width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 历史报表 -->
        <div class="mx-3 mt-4">
            <h3 class="font-semibold text-gray-800 mb-4 text-base">
                <i class="fas fa-history mr-2 text-gray-600"></i>
                历史报表
            </h3>
            
            <div class="space-y-3">
                <!-- 报表记录1 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-file-excel text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">2024-12-20 日报表</h4>
                                <p class="text-sm text-gray-500">Excel格式 | 15人参与</p>
                            </div>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors" onclick="downloadReport('2024-12-20')">
                            <i class="fas fa-download mr-1"></i>
                            下载
                        </button>
                    </div>
                </div>

                <!-- 报表记录2 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-file-excel text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">2024-12-19 日报表</h4>
                                <p class="text-sm text-gray-500">Excel格式 | 12人参与</p>
                            </div>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors" onclick="downloadReport('2024-12-19')">
                            <i class="fas fa-download mr-1"></i>
                            下载
                        </button>
                    </div>
                </div>

                <!-- 报表记录3 -->
                <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-file-excel text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-base">2024-12-18 日报表</h4>
                                <p class="text-sm text-gray-500">Excel格式 | 10人参与</p>
                            </div>
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors" onclick="downloadReport('2024-12-18')">
                            <i class="fas fa-download mr-1"></i>
                            下载
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 底部间距 -->
        <div class="h-20"></div>
    </div>

    <script>
        // 当前选择的统计周期
        let currentDateRange = 'today';

        // 设置日期范围
        function setDateRange(range) {
            // 移除所有按钮的激活状态
            document.querySelectorAll('.grid.grid-cols-2 button').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white', 'shadow-sm');
                btn.classList.add('bg-gray-100', 'text-gray-600');
            });
            
            // 激活当前按钮
            event.target.classList.remove('bg-gray-100', 'text-gray-600');
            event.target.classList.add('bg-blue-600', 'text-white', 'shadow-sm');
            
            // 更新当前统计周期
            currentDateRange = range;
            
            // 如果是自定义，弹出日期选择
            if (range === 'custom') {
                const date = prompt('请输入日期 (YYYY-MM-DD):', '2024-12-20');
                if (date) {
                    console.log('选择日期:', date);
                    // 这里可以添加根据日期筛选数据的逻辑
                }
            } else {
                // 这里可以添加数据筛选逻辑
                console.log('切换到时间范围:', range);
            }
        }

        // 切换门店筛选下拉框
        function toggleStoreFilter() {
            const dropdown = document.getElementById('storeFilterDropdown');
            dropdown.classList.toggle('hidden');
        }

        // 更新门店筛选
        function updateStoreFilter() {
            const checkboxes = document.querySelectorAll('#storeFilterDropdown input[type="checkbox"]');
            const allCheckbox = document.querySelector('#storeFilterDropdown input[value="all"]');
            const storeCheckboxes = Array.from(checkboxes).filter(cb => cb.value !== 'all');
            const selectedStores = [];
            
            // 处理"全部门店"选项
            if (event.target.value === 'all') {
                if (event.target.checked) {
                    // 选中"全部门店"时，取消其他选项
                    storeCheckboxes.forEach(cb => cb.checked = false);
                    selectedStores.push('all');
                } else {
                    // 取消"全部门店"时，选中所有门店
                    storeCheckboxes.forEach(cb => cb.checked = true);
                    storeCheckboxes.forEach(cb => selectedStores.push(cb.value));
                }
            } else {
                // 处理具体门店选项
                if (event.target.checked) {
                    selectedStores.push(event.target.value);
                    // 如果所有门店都被选中，自动选中"全部门店"
                    if (storeCheckboxes.every(cb => cb.checked)) {
                        allCheckbox.checked = true;
                    }
                } else {
                    // 取消具体门店时，取消"全部门店"
                    allCheckbox.checked = false;
                    storeCheckboxes.forEach(cb => {
                        if (cb.checked) selectedStores.push(cb.value);
                    });
                }
            }
            
            // 更新按钮文本
            updateFilterButtonText(selectedStores);
            
            // 执行筛选
            filterByStores(selectedStores);
        }

        // 更新筛选按钮文本
        function updateFilterButtonText(selectedStores) {
            const filterText = document.getElementById('storeFilterText');
            
            if (selectedStores.includes('all') || selectedStores.length === 0) {
                filterText.textContent = '全部门店';
            } else if (selectedStores.length === 1) {
                filterText.textContent = selectedStores[0];
            } else {
                filterText.textContent = `已选${selectedStores.length}个门店`;
            }
        }

        // 按门店筛选员工
        function filterByStores(selectedStores) {
            const employeeCards = document.querySelectorAll('.space-y-3 > .bg-white');
            
            employeeCards.forEach(card => {
                const storeText = card.querySelector('.text-xs.text-gray-500').textContent;
                const storeName = storeText.split(' | ')[1];
                
                if (selectedStores.includes('all') || selectedStores.includes(storeName)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // 点击其他地方关闭下拉框
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('storeFilterDropdown');
            const button = document.getElementById('storeFilterBtn');
            
            if (!button.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });

        // 显示导出选项
        function showExportOptions() {
            // 根据当前统计周期确定报表类型
            let reportType = '日报';
            if (currentDateRange === 'week') {
                reportType = '周报';
            } else if (currentDateRange === 'month') {
                reportType = '月报';
            } else if (currentDateRange === 'custom') {
                reportType = '自定义报表';
            }
            
            const options = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-xl p-6 mx-4 w-80">
                        <h3 class="font-semibold text-gray-800 mb-4 text-center">选择导出类型</h3>
                        <div class="space-y-3">
                            <button class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg text-sm font-medium transition-colors" onclick="exportReport('completed')">
                                <i class="fas fa-check-circle mr-2"></i>
                                已完成名单
                            </button>
                            <button class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg text-sm font-medium transition-colors" onclick="exportReport('incomplete')">
                                <i class="fas fa-times-circle mr-2"></i>
                                未完成名单
                            </button>
                            <button class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg text-sm font-medium transition-colors" onclick="exportReport('all')">
                                <i class="fas fa-list mr-2"></i>
                                全部名单
                            </button>
                        </div>
                        <div class="text-center text-xs text-gray-500 mt-2">
                            当前统计周期：${reportType}
                        </div>
                        <button class="w-full bg-gray-100 hover:bg-gray-200 text-gray-600 px-4 py-2 rounded-lg text-sm font-medium transition-colors mt-4" onclick="closeExportModal()">
                            取消
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', options);
        }

        // 关闭导出模态框
        function closeExportModal() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                modal.remove();
            }
        }

        // 导出报表
        function exportReport(type) {
            closeExportModal();
            
            // 根据当前统计周期确定报表类型
            let reportType = '日报';
            if (currentDateRange === 'week') {
                reportType = '周报';
            } else if (currentDateRange === 'month') {
                reportType = '月报';
            } else if (currentDateRange === 'custom') {
                reportType = '自定义报表';
            }
            
            // 显示加载状态
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<div class="loading mr-2"></div>导出中...';
            btn.disabled = true;
            
            // 模拟导出过程
            setTimeout(() => {
                let message = '';
                switch(type) {
                    case 'completed':
                        message = `已完成名单${reportType}导出成功！`;
                        break;
                    case 'incomplete':
                        message = `未完成名单${reportType}导出成功！`;
                        break;
                    case 'all':
                        message = `全部名单${reportType}导出成功！`;
                        break;
                }
                alert(message);
                
                // 恢复按钮状态
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 2000);
        }

        // 下载报表
        function downloadReport(date) {
            alert(`正在下载 ${date} 的报表...`);
        }
    </script>
</body>
</html>
